<!DOCTYPE html>
<html>
  <head>
    <!-- requirejs config -->
    <script>
      var require = {
        baseUrl : '../', 
      };
    </script>
    <!-- requirejs -->
    <script type="text/javascript" src="../../lib/require.js"></script>
    <!--  main -->
    <script text="javascript">
      var cue;
      require(['timingsrc'], function (timingsrc) {

        a = new timingsrc.Axis();

        var Cue = timingsrc.Cue;
        var Interval = timingsrc.Interval;

        var makeBatch = function (size, random, scale) {
          let batch = [];
          random = random || false;
          scale = scale || 1;
          for (let i=0; i<size; i++) {
            if (random) {
              low = Math.random()*scale;
            } else {
              low = i;
            }
            batch.push(low);
          }
          return batch;
        };

        var timeit = function (func, name) {
          let t0 = performance.now();
          let result = func();
          let t1 = performance.now();
          console.log(name, t1-t0);
          return result;
        };



        var binary1 = function (batch1, batch2) {
          let b = new timingsrc.BinarySearch(batch1);
          timeit(function () {
            b.insertBatch(batch2);
          }, "binary1 insert " + batch1.length + " " + batch2.length);

        };

        var binary2 = function (batch1, batch2) {
          let b = new timingsrc.BinarySearch(batch1);
          timeit(function () {
            b.insertBatch2(batch2);
          }, "binary2 insert " + batch1.length + " " + batch2.length);
        };


        var timeitmakebatch = function (size) {
          let result;
          timeit(function () {
            result = makeBatch(size);
          }, "batch " + size);
          return result;
        };

        var run = function () {


          let DATASIZE = 1000000;
          let BATCHSIZE = 55;

          let batch1 = timeitmakebatch(DATASIZE);
          let big_batch1 = binary1(batch1, makeBatch(BATCHSIZE, true, DATASIZE));
          
          let batch2 = timeitmakebatch(DATASIZE);
          let big_batch2 = binary2(batch2, makeBatch(BATCHSIZE, true, DATASIZE));
       
  

        };




        if (document.readyState === "complete") run();
        else window.onload = run;
      });
    </script>    
  </head>
  <body>
    <h1>Test Axis</h1>
  </body>
</html>